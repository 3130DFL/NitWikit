---
sidebar_position: 1
---

# 概览

什么是优化? 优化不是装插件, 首先得明白为什么服务器会卡, tps是什么, 每个服务器可能有自己的卡顿原因, 在这部分先做最基础的通用优化, 如果你使用后作用不大请参考性能分析板块.

![](./_images/TPS不稳定有优化插件推荐吗.png)

:::note

各位大佬们, 服务器卡不是装个插件就能解决的

:::

![](_images/ummm.jpg)

(好的, 现在切入正题)

# 第一步 - 优化服务端配置

<details>
<summary>如何优化</summary>

目前, Bilibili上面的配置都是很老的, 不推荐使用

看咱文档里的 [点这里](调服务端配置.md) 比较新, 非常推荐

</details>

# 第二步 - Java 优化

此部分分为两步

## 选择合适的JAVA

### 版本

原则上选择最新的兼容的JAVA版本, 可以体验到最新的优化, 并且大部分现代插件都对最新版的特性有专门的兼容（比如AuthMeReReload).

如遇到低版本服务器不兼容高版本java的问题在paper及其分支可尝试在JVM启动时添加参数-DPaper.IgnoreJavaVersion=true

根据各路大佬的测试Zulu相较Oracle(你可以看做"公版")更适合开MC服务器

[Zulu下载链接](https://www.azul.com/downloads/?package=jdk#zulu)

下滑并选择你的操作系统/java版本等即可下载安装.

## JVM 参数优化

可以在[JVM参数生成器](https://startmc.jakaco.xyz/)生成最适合你服务器的JVM参数, 然后应用到你的启动脚本里, 然后重启就完成了

别急. 还有一些更高阶的参数. [拓展阅读](https://blog.binklac.com/e6ad4dc21152)

# 第三步 - 更换核心

在插件和配置层面能进行的优化其实不多（受限于API还有服务端核心), 所以最好的方法是更换服务器核心

<details>
<summary>选择更换的服务器核心</summary>

:::danger

1. 不要相信什么付费优化核心, 已经花过钱给大家买过测试过了, 如果你愿意花这钱的话, 那就去买吧

2. 混合服务器最好不要装优化模组, 会破坏很多插件的兼容性, 这个经验在服务器已经多次实践

:::

## Purpur - 稳定性与性能最佳选择

如果你并不是追求更极致的性能, Purpur 你最好的选择, 只需要替换掉核心就可以, Purpur 兼容全部插件!!

## Leaf - 极致性能

前往Leaf的Github Action 下载最新核心, 然后替换!!, Leaf 兼容你的绝大部分插件(已知仅有一个不兼容, 但在插件的分支解决)

## Folia - 硬件利用率超高的高性能, 但兼容性较差

如果你的服务器对插件的需求不大, 或者你的插件已全部兼容Folia, 那你就可以选择切换到这个核心, 你的tps有绝对巨大的提升(甚至超过了Leaf)

回归原初:服务端核心选择

</details>

# 第四步 - 更换硬件

不要无脑换硬件! 首先要知道自己的硬件瓶颈在哪里. 如果CPU负荷过高, 建议先排除CPU异常占用, 再看CPU总体占用情况. 一般来说服务器卡顿换CPU是最有效的, 单核性能和MC服务器TPS几乎呈线性相关, 但是换CPU几乎就相当于要换一台机器, 迁移对于新手来说并不是易事.

对于单端服务器来说, 超过8核心的部分基本很难通过提升CPU核心数量提升TPS. 不要动不动就买E5 然后卡了就加4核心8g内存, 更多也没用的.

对于群组服务器来说, 一般核心数量都会占用上, 但是内存可能会有些捉急, 对于每一个普通的生存服来说内存的推荐值为 8G-20G 更多更少都是不推荐的.

:::warning
如果发现CPU占用和内存占用都不是很高但是服务器卡卡的, 请考虑是不是服务器带宽受限导致玩家ping值突然升高的问题. 请分清楚TPS低导致的卡顿, MSPT高导致的卡顿, 带宽占满导致的卡顿.
:::

# 第五步 - 更换操作系统

Linux 比 Windows 更适合用于开服, 你可以获得更快的发包速度和接收速度, 并且可以获得更好的性能(这不是玄学, 根据测试TPS能提升8-15%, 接入服务器速度将提升数十毫秒起), 除此之外, linux的稳定性是Windows无论如何也无法比拟的.
